/* Page transition animations with Swup - Enhanced silky smooth version */

/* CRITICAL: Force disable music player animations during page transitions */
/* Swup adds html.is-changing when a transition starts */
html.is-changing .music-player-widget,
html.is-changing .music-player-widget *,
html.is-changing .animate-spin-slow,
html.is-animating .music-player-widget,
html.is-animating .music-player-widget *,
html.is-animating .animate-spin-slow {
    animation: none !important;
    animation-duration: 0ms !important;
    animation-delay: 0ms !important;
    transition: none !important;
    transition-duration: 0ms !important;
}

/* ============================================
   主要内容区域的过渡动画 - 丝滑版本
   参考: blog.mysqil.com 的淡入淡出 + 轻微上滑效果
   ============================================ */

/* 基础过渡设置 - 使用更平滑的 cubic-bezier */
.transition-main {
    transition:
        opacity 350ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 350ms cubic-bezier(0.4, 0, 0.2, 1);
    will-change: opacity, transform;
}

/* 离开动画类 */
.transition-leaving {
    transition:
        transform 280ms cubic-bezier(0.4, 0, 1, 1),
        opacity 280ms cubic-bezier(0.4, 0, 1, 1);
}

/* Swup 切换时的动画 */
html.is-changing .transition-main {
    transition:
        opacity 350ms cubic-bezier(0.4, 0, 0.2, 1),
        transform 350ms cubic-bezier(0.4, 0, 0.2, 1);
}

html.is-leaving .transition-main {
    transition:
        opacity 280ms cubic-bezier(0.4, 0, 1, 1),
        transform 280ms cubic-bezier(0.4, 0, 1, 1);
}

/* 进入动画 - 仅使用垂直上滑，更轻盈 */
html.is-animating .transition-main {
    opacity: 0;
    transform: translateY(16px);
}

/* 离开动画 - 向上淡出，轻微 */
html.is-animating.is-leaving .transition-leaving {
    transform: translateY(-8px);
    opacity: 0;
}

/* Swup fade 动画 - 保持兼容性 */
html.is-changing .transition-fade {
    transition: all 350ms cubic-bezier(0.4, 0, 0.2, 1);
}

html.is-animating .transition-fade {
    opacity: 0;
    transform: translateY(12px);
}

/* ============================================
   页面加载动画 - 丝滑淡入
   ============================================ */

@keyframes fade-in-up {
    from {
        opacity: 0;
        transform: translateY(16px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fade-out-up {
    from {
        opacity: 1;
        transform: translateY(0);
    }

    to {
        opacity: 0;
        transform: translateY(-8px);
    }
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

/* 页面加载动画类 */
.onload-animation {
    opacity: 0;
    animation: fade-in-up 400ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.onload-animation-fade-in {
    opacity: 0;
    animation: fade-in 350ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* 渐进式动画延迟 - 更流畅的错开效果 */
.onload-animation:nth-child(1) {
    animation-delay: 0ms;
}

.onload-animation:nth-child(2) {
    animation-delay: 40ms;
}

.onload-animation:nth-child(3) {
    animation-delay: 80ms;
}

.onload-animation:nth-child(4) {
    animation-delay: 120ms;
}

.onload-animation:nth-child(5) {
    animation-delay: 160ms;
}

.onload-animation:nth-child(6) {
    animation-delay: 200ms;
}

/* ============================================
   特殊元素的动画
   ============================================ */

/* 滑入动画 */
.transition-slide-in {
    opacity: 0;
    transform: translateY(16px);
    transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
}

.transition-slide-in.active {
    opacity: 1;
    transform: translateY(0);
}

/* 卡片动画 - 更轻盈的效果 */
.card-animation {
    opacity: 0;
    transform: translateY(20px) scale(0.99);
    transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
}

.card-animation.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
}

/* 导航动画 */
.nav-animation {
    opacity: 0;
    transform: translateX(-16px);
    transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-animation.loaded {
    opacity: 1;
    transform: translateX(0);
}

/* ============================================
   性能优化
   ============================================ */

.transition-main,
.transition-leaving,
.onload-animation,
.transition-slide-in,
.card-animation {
    backface-visibility: hidden;
    -webkit-font-smoothing: antialiased;
    transform-style: preserve-3d;
}

/* ============================================
   响应式调整
   ============================================ */

@media (max-width: 768px) {

    /* 移动端优化：稍微减少动画幅度 */
    html.is-animating .transition-main {
        transform: translateY(12px);
    }

    html.is-animating.is-leaving .transition-leaving {
        transform: translateY(-6px);
    }

    .transition-slide-in {
        transform: translateY(12px);
    }

    .card-animation {
        transform: translateY(12px) scale(0.995);
    }

    /* 移动端优化：硬件加速 */
    .transition-main,
    .transition-leaving,
    .onload-animation,
    .transition-slide-in,
    .card-animation {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
}

/* ============================================
   减少动画的用户偏好设置
   ============================================ */

@media (prefers-reduced-motion: reduce) {

    .transition-main,
    .transition-leaving,
    .onload-animation,
    .transition-slide-in,
    .card-animation,
    .nav-animation {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}